webpackJsonp([1],{NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),o=s("wh8N"),n=s.n(o);const a=0;var r;!function(t){t.Above="Above",t.Below="Below",t.Left="Left",t.Right="Right"}(r||(r={}));var h=class{constructor(t){if(this.dy=t.length,this.dx=t[0].length,this.dy<2||this.dx<2)throw new Error("cannot initialize with the array which has less than 2 col/rows");this.blocks=new Array(this.dx*this.dy);let e=0;for(let s=0;s<this.dy;s++)for(let i=0;i<this.dx;i++)this.blocks[e]=t[s][i],t[s][i]===a&&(this.blankpos=e),e++}row(t){return Math.floor(t/this.dx)}col(t){return t%this.dx}dimensions(){return{x:this.dx,y:this.dy}}checkInRange(...t){for(let e of t)if(null==this.blocks[e])throw new Error(`Index ${e} not in range [0 .. ${this.blocks.length-1}]`)}direction(t,e){if(this.checkInRange(t,e),this.row(e)===this.row(t)){if(e%this.dx==t%this.dx-1)return r.Left;if(e%this.dx==t%this.dx+1)return r.Right}return e===t+this.dx?r.Below:e===t-this.dx?r.Above:null}hamming(){let t=0;for(let e=0,s=1,i=this.blocks.length;e<i;e++,s++)this.blocks[e]!==a&&this.blocks[e]!==s&&t++;return t}manhattan(){let t=0;for(let e=0,s=this.blocks.length;e<s;e++)this.blocks[e]!==a&&(t+=Math.abs(this.row(this.blocks[e]-1)-this.row(e))+Math.abs(this.col(this.blocks[e]-1)-this.col(e)));return t}isGoal(){for(let t=0,e=this.blocks.length;t<e;t++)if(this.blocks[t]!==a&&this.blocks[t]!==t+1)return!1;return!0}swap(t,e,s){if(this.checkInRange(e,s),this.blocks[e]!==a&&this.blocks[s]!==a)throw new Error("cannot swap non-space block");return[t[e],t[s]]=[t[s],t[e]],this.blankpos=t[e]===a?e:s,this}swapAbove(t){return this.swap(this.blocks,t,t-this.dx)}swapBelow(t){return this.swap(this.blocks,t,t+this.dx)}swapLeft(t){return this.swap(this.blocks,t,t-1)}swapRight(t){return this.swap(this.blocks,t,t+1)}slide(t){switch(this.checkInRange(t),this.direction(t,this.blankpos)){case r.Above:return this.swapAbove(t);case r.Below:return this.swapBelow(t);case r.Left:return this.swapLeft(t);case r.Right:return this.swapRight(t);default:return this}}toArray2D(){let t=0;const e=[];for(let s=0;s<this.dy;s++){const s=[];for(let e=0;e<this.dx;e++,t++)s.push(this.blocks[t]);e.push(s)}return e}},l=s("xkHn"),c=s.n(l),d=s("y1vT"),u=s.n(d),f=s("vy4U"),b=s.n(f),p=function(t,e){for(var s=t*e,i=[],o=0;o<s;o++)i.push(o);!function(t){for(var e=t.length-1;e>0;e--){var s=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[s],t[s]=i}}(i);for(var n=[],a=0;a<e;a++){for(var r=[],h=0;h<t;h++)r.push(i[t*a+h]);n.push(r)}return n},v={name:"PuzzleBoard",data:function(){return this._blockPositions=[],{isTouchNeeded:!0,blocks:this.board.blocks,isGoal:!1,manhattan:null,hamming:null,width:0,height:0,vidSrc:n.a,targetSrc:this.src,posterSrc:c.a,dx:this.board.dx,dy:this.board.dx}},props:{board:{type:h,default:function(){var t=p(3,3);return new h(t)}},src:{type:String},showNumber:{type:Boolean,default:!0},autoResize:{type:Boolean,default:!1}},computed:{cellWidth:function(){return this.width/this.dx},cellHeight:function(){return this.height/this.dy}},mounted:function(){var t=this;this.onResize(),this.updateBlockPositions(),window.addEventListener("resize",u()(this.onResize.bind(this),300)),this._lastRender=-1,this.$refs.sourceImg.addEventListener("play",function(){var e=t.$refs["puzzle-canvas"].getContext("2d");e.font="24px 'Avenir', Helvetica, Arial, sans-serif",e.fillStyle="#fafafa",e.textBaseline="top",t.isTouchNeeded=!1});this.$nextTick(function e(){if(b.a.update(),null!=t.$refs.sourceImg){var s=t.$refs.sourceImg;if(s.currentTime!==t._lastRender){t._lastRender=s.currentTime;var i=Math.min(s.videoWidth/t.dx,s.videoHeight/t.dy),o=(s.videoWidth-i*t.dx)/2,n=(s.videoHeight-i*t.dy)/2,a=t.$refs["puzzle-canvas"],r=a.getContext("2d"),h=i*t.dx,l=i*t.dy,c=t.width,d=t.height;if(r.clearRect(0,0,t.width,t.height),r.drawImage(s,o,n,h,l,c,0,c,d),!t.isGoal&&t.showNumber)for(var u=0,f=t.blocks.length;u<f;u++){var p=Math.floor(u/t.dx),v=u%t.dx,w=String(u+1);r.strokeText(w,5+c+t.cellWidth*v,5+t.cellHeight*p),r.fillText(w,5+c+t.cellWidth*v,5+t.cellHeight*p)}for(var g=0,m=t.blocks.length;g<m;g++){var k=t.blocks[g];if(0!==k){var x=t.board.row(k-1),y=t.board.col(k-1),z=t.cellWidth*y+c,_=t.cellHeight*x,N=t._blockPositions[k];if(null!=N){var R=N.x,C=N.y;r.drawImage(a,z,_,t.cellWidth,t.cellHeight,R,C,t.cellWidth,t.cellHeight)}}}}requestAnimationFrame(e)}else requestAnimationFrame(e)})},watch:{board:function(){this.blocks=this.board.blocks,this.dx=this.board.dx,this.dy=this.board.dy},blocks:function(){this.updateBlockPositions(),this.isGoal=this.board.isGoal(),this.manhattan=this.board.manhattan(),this.hamming=this.board.hamming(),this.$emit("change",{blocks:this.blocks,isGoal:this.isGoal,distance:this.manhattan})},isGoal:function(){this.isGoal&&this.$emit("finish")}},methods:{updateBlockPositions:function(){for(var t=this,e=function(e,s){var i=t.blocks[e],o=t.board.col(e),n=t.board.row(e),a=t.cellWidth*o,r=t.cellHeight*n,h=t._blockPositions[i]||{x:0,y:0};if(null==t._blockPositions[i]&&(t._blockPositions[i]=h),h.x-a==0&&h.y-r==0)return"continue";var l={x:h.x,y:h.y};new b.a.Tween(l).to({x:a,y:r},200).easing(b.a.Easing.Quadratic.Out).onUpdate(function(){t._blockPositions[i].x=l.x,t._blockPositions[i].y=l.y}).start()},s=0,i=this.blocks.length;s<i;s++)e(s)},getCanvasStyle:function(){return{left:this.isGoal?"-100%":0}},getSourceStyle:function(){return{display:"none"}},slide:function(t){this.board.slide(t),i.a.set(this,"blocks",this.board.blocks.concat())},onTouchEnd:function(t){this.isTouchNeeded&&(this.$refs.sourceImg.play(),this.isTouchNeeded=!1);var e=t.changedTouches[0],s=this.$el.getBoundingClientRect(),i={offsetX:e.clientX-s.left,offsetY:e.clientY-s.top};this.onClick(i)},onClick:function(t){var e=Math.floor(t.offsetX/this.cellWidth),s=Math.floor(t.offsetY/this.cellHeight)*this.dx+e;this.slide(s)},onClickBoard:function(){this.$el.focus()},onResize:function(){var t=this.$el.offsetWidth,e=this.$el.offsetHeight;this.autoResize&&(this.width=t,this.height=e)},onKeyUp:function(t){var e=this.board.blankpos,s=this.blocks.length;switch(t.keyCode){case 37:e+1<s&&this.slide(e+1);break;case 38:e+this.dx<s&&this.slide(e+this.dx);break;case 39:e-1>=0&&this.slide(e-1);break;case 40:e-this.dx>=0&&this.slide(e-this.dx)}}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"puzzle-board",attrs:{tabindex:"-1"},on:{keyup:function(e){e.preventDefault(),t.onKeyUp(e)},click:t.onClickBoard}},[t.isTouchNeeded?s("div",{staticClass:"puzzle-message"},[t._v("Touch to start")]):t._e(),t._v(" "),s("canvas",{ref:"puzzle-canvas",staticClass:"puzzle-canvas",style:t.getCanvasStyle(),attrs:{width:2*t.width,height:t.height},on:{click:function(t){t.preventDefault()},mousedown:function(t){t.preventDefault()},mouseup:function(e){e.preventDefault(),t.onClick(e)},touchend:function(e){e.preventDefault(),t.onTouchEnd(e)}}}),t._v(" "),s("video",{ref:"sourceImg",style:t.getSourceStyle(),attrs:{autoplay:"",loop:"",muted:"true",width:t.width,height:t.height,src:t.vidSrc},domProps:{muted:!0}},[t._v("No video")])])},staticRenderFns:[]};var g={name:"App",components:{PuzzleBoard:s("VU/8")(v,w,!1,function(t){s("xPuO")},"data-v-92c7d4d8",null).exports},data:function(){return{imgSrc:c.a,distance:null,isGoal:!1,autoResize:!0,showNumber:!1}},methods:{onPuzzleBoardFinish:function(){this.isGoal=!0},onPuzzleBoardChange:function(t){this.distance=t.distance}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"header"},[s("span",{staticClass:"header-item title"},[t._v("Vue-8-Puzzle")]),t._v(" "),s("span",{staticClass:"header-item distance"},[t._v(" Distance: "+t._s(t.distance)+" ")]),t._v(" "),s("span",{staticClass:"header-item"},[s("label",{attrs:{for:"showNumber"}},[t._v("Show Number:")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.showNumber,expression:"showNumber"}],attrs:{type:"checkbox",id:"showNumber"},domProps:{checked:Array.isArray(t.showNumber)?t._i(t.showNumber,null)>-1:t.showNumber},on:{change:function(e){var s=t.showNumber,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.showNumber=s.concat([null])):n>-1&&(t.showNumber=s.slice(0,n).concat(s.slice(n+1)))}else t.showNumber=o}}})]),t._v(" "),s("span",{staticClass:"header-item"},[t.isGoal?[t._v("\n        finish!!\n      ")]:t._e()],2)]),t._v(" "),s("div",{staticClass:"container"},[s("puzzle-board",{attrs:{src:t.imgSrc,autoResize:t.autoResize,showNumber:t.showNumber},on:{change:t.onPuzzleBoardChange,finish:t.onPuzzleBoardFinish}})],1)])},staticRenderFns:[]};var k=s("VU/8")(g,m,!1,function(t){s("e/0Q")},null,null).exports;i.a.config.productionTip=!1,new i.a({el:"#app",components:{App:k},template:"<App/>"})},"e/0Q":function(t,e){},wh8N:function(t,e,s){t.exports=s.p+"static/media/cat.ae00415.webm"},xPuO:function(t,e){},xkHn:function(t,e,s){t.exports=s.p+"static/img/robot.ca73761.jpg"}},["NHnr"]);
//# sourceMappingURL=app.3a807296e0864fc2c173.js.map